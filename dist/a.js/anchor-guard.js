define(function(require,exports,module){var swf=require("./anchor-swf"),Tools=require("./anchor-tools");module.exports={sfbox:$(".start-watch"),changeTimeBtn:$(".sftext"),timeList:$(".sf-times"),startWatchBtn:$("#watchButton"),clz:$(".start-watch .clz"),price:88800,contoiner:$(".guard-main"),init:function(data){var _this=this,params=jQuery.parseJSON(data.params),rtype=UIF.roomType;this.rtype=rtype,_this.price=eval("params."+rtype+".guard")+"00",$(".sfpeice").text("总价格"+_this.price*parseInt($(".sftext").text())+"K豆"),this.sfbox=$(".start-watch"),this.changeTimeBtn=$(".sftext"),this.timeList=$(".sf-times"),this.startWatchBtn=$("#watchButton"),this.clz=$(".start-watch .clz"),this.sta=$(".kais"),this.getGuardList(),this.changeEvent(),this.startWatch()},getGuardList:function(t){htm="";var i=0;if(null!=t&&(t=t.sort(Tools.sortBy("grds",1)),$.each(t,function(){i++;var t=$(this);t[0].grds=t[0].grds,htm+='<li><div class="guardYou"><div class="gback glv1"><img src="'+t[0].himage+'" class="img2"/>\t\t                        <span class="img3">'+t[0].days+'<br />天</span>\t\t                        <img src="/static_data/images_css/guardbox/'+t[0].levelImage+'" class="img1"/>\t\t                        </div>\t\t                        <div class="gname"><a href="#"  title="'+decodeURI(t[0].name)+'">'+decodeURI(t[0].name)+"</a></div></div></li>"})),i<8)for(var e=1;e<=6-i;e++)htm+='<li><div class="no-circle"></div></li>';$(".gdnum").text(i+"/32"),$(".guard-main ul").html(htm)},changeEvent:function(){var t=this;t.changeTimeBtn.on("mouseover",function(){t.timeList.show()}),t.timeList.find("li").on("click",function(){var i=$(this).attr("dv"),e=i*t.price;t.changeTimeBtn.text(i),t.changeTimeBtn.text(i),$(".sfpeice").text("总价格"+e+"K豆"),t.clzTimelist()}),t.timeList.on("mouseleave",function(){$(this).hide()}),t.clz.on("click",function(){t.sfbox.hide()}),t.sta.on("click",function(){return UIF.handler.login?void t.sfbox.show():void UIF.handler.loging()}),t.contoiner.on("click",".no-circle",function(){return UIF.handler.login?void t.sfbox.show():void UIF.handler.loging()}),t.contoiner.on("mouseover","li .img1",function(t){$(this).siblings(".img3").slideToggle(100)}).on("mouseleave","li .img1",function(t){$(this).siblings(".img3").hide()})},startWatch:function(){var t=this;t.startWatchBtn.on("click",function(){UIF.handler.sendAddGuard({guardDT:t.changeTimeBtn.text(),rtype:t.rtype},function(i){var e=jQuery.parseJSON(i);null!=e&&200==e.resultStatus?Tools.dialog("开通成功"):100==e.resultStatus?Tools.dialog("余额不足"):Tools.dialog(e.resultMessage),t.sfbox.hide()})})},refreshGuardList:function(t){this.getGuardList(t)},clzTimelist:function(){this.timeList.hide()},onMessage:function(t){swf.guardLevelup({guardLevel:t.grds,nickname:decodeURI(t.name)})}}});